"use strict";(self.webpackChunkyui_docs_yui_ibc_solidity=self.webpackChunkyui_docs_yui_ibc_solidity||[]).push([[672],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return f}});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=o.createContext({}),s=function(e){var n=o.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},u=function(e){var n=s(e.components);return o.createElement(c.Provider,{value:n},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},h=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(t),h=r,f=d["".concat(c,".").concat(h)]||d[h]||p[h]||i;return t?o.createElement(f,a(a({ref:n},u),{},{components:t})):o.createElement(f,a({ref:n},u))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,a=new Array(i);a[0]=h;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l[d]="string"==typeof e?e:r,a[1]=l;for(var s=2;s<i;s++)a[s]=t[s];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}h.displayName="MDXCreateElement"},4124:function(e,n,t){t.r(n),t.d(n,{assets:function(){return c},contentTitle:function(){return a},default:function(){return p},frontMatter:function(){return i},metadata:function(){return l},toc:function(){return s}});var o=t(3117),r=(t(7294),t(3905));const i={sidebar_position:5},a="Execute token transfer",l={unversionedId:"minitoken/interaction",id:"minitoken/interaction",title:"Execute token transfer",description:"For the environment deployed so far,",source:"@site/docs/minitoken/interaction.md",sourceDirName:"minitoken",slug:"/minitoken/interaction",permalink:"/yui-docs/yui-ibc-solidity/minitoken/interaction",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Deploy contracts",permalink:"/yui-docs/yui-ibc-solidity/minitoken/deploy"}},c={},s=[{value:"Initial balances for Alice and Bob",id:"initial-balances-for-alice-and-bob",level:2},{value:"Mint to Alice on ledger IBC0",id:"mint-to-alice-on-ledger-ibc0",level:2},{value:"Check the block height on ledger IBC1",id:"check-the-block-height-on-ledger-ibc1",level:2},{value:"Transfer token from Alice on ledger IBC0 to Bob on ledger IBC1",id:"transfer-token-from-alice-on-ledger-ibc0-to-bob-on-ledger-ibc1",level:2},{value:"Check the MiniToken balance from Bob on the ledger IBC1.",id:"check-the-minitoken-balance-from-bob-on-the-ledger-ibc1",level:2}],u={toc:s},d="wrapper";function p(e){let{components:n,...t}=e;return(0,r.kt)(d,(0,o.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"execute-token-transfer"},"Execute token transfer"),(0,r.kt)("p",null,"For the environment deployed so far,\nuse ",(0,r.kt)("inlineCode",{parentName:"p"},"truffle console")," to transfer the token to the environment we have just deployed."),(0,r.kt)("p",null,"The ledger and network names used here are as follows"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"IBC0 (network name is ",(0,r.kt)("inlineCode",{parentName:"li"},"ibc0"),")"),(0,r.kt)("li",{parentName:"ul"},"IBC1 (network name is ",(0,r.kt)("inlineCode",{parentName:"li"},"ibc1"),")")),(0,r.kt)("p",null,"To run truffle console with the network name, do the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"truffle console --network=<network name>\n")),(0,r.kt)("p",null,"The actors on the ledger are the following for both ledgers"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Alice (",(0,r.kt)("inlineCode",{parentName:"li"},"accounts[1]"),")"),(0,r.kt)("li",{parentName:"ul"},"Bob (",(0,r.kt)("inlineCode",{parentName:"li"},"accounts[2]"),")")),(0,r.kt)("h2",{id:"initial-balances-for-alice-and-bob"},"Initial balances for Alice and Bob"),(0,r.kt)("p",null,"Make sure that the following balances are zero."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Alice on IBC0"),(0,r.kt)("li",{parentName:"ul"},"Bob on IBC1")),(0,r.kt)("p",null,"For each, you can switch the network to connect to and check the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// i = 1 for Alice, i = 2 for Bob\nMiniToken.deployed()\n    .then((instance) => instance.balanceOf(accounts[i]))\n")),(0,r.kt)("h2",{id:"mint-to-alice-on-ledger-ibc0"},"Mint to Alice on ledger IBC0"),(0,r.kt)("p",null,"Prepare just 100 MiniTokens on Alice."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const accounts = await web3.eth.getAccounts();\nconst alice = accounts[1];\n\nawait MiniToken.deployed().then(instance => instance.mint(alice, 100));\n")),(0,r.kt)("p",null,"When ",(0,r.kt)("inlineCode",{parentName:"p"},"mint")," succeeds, the ",(0,r.kt)("inlineCode",{parentName:"p"},"Mint")," event will be emitted. To check this, do the following."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'MiniToken.deployed()\n    .then(instance => instance.getPastEvents("Mint", { fromBlock: 0 }))\n    .then(event => console.log(event));\n')),(0,r.kt)("h2",{id:"check-the-block-height-on-ledger-ibc1"},"Check the block height on ledger IBC1"),(0,r.kt)("p",null,"When sending a Packet from IBC0 to IBC1, it's necessary to specify the height at which it will timeout based on the receiving ledger IBC1.\nTherefore, let's check the current block height on IBC1."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"await web3.eth.getBlockNumber()\n")),(0,r.kt)("h2",{id:"transfer-token-from-alice-on-ledger-ibc0-to-bob-on-ledger-ibc1"},"Transfer token from Alice on ledger IBC0 to Bob on ledger IBC1"),(0,r.kt)("p",null,"Transfer 50 MiniTokens to Bob on IBC1.\nFor the height at which the Packet will timeout on the receiving ledger, specify a height that adds sufficiently to the one previously obtained for IBC1, ensuring adequate time for Packet relay.\nFor instance, if the height of IBC1 was 500, considering that this operation will be performed immediately afterward, adding about 1000 should be enough, depending on the environment."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'const port = "transfer";\nconst channel = "channel-0";\n\nconst bob = accounts[2];\n// Please configure according to your environment\nconst timeoutHeight = 1500;\nawait MiniToken.deployed()\n    .then(instance => instance.sendTransfer(50, bob, port, channel, timeoutHeight, {from: alice}));\n')),(0,r.kt)("h2",{id:"check-the-minitoken-balance-from-bob-on-the-ledger-ibc1"},"Check the MiniToken balance from Bob on the ledger IBC1."),(0,r.kt)("p",null,"It will take some time for the Packet to be relayed.\nAfter that, you can see that the balance has increased as shown below."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"await MiniToken.deployed()\n    .then((instance) => instance.balanceOf(bob));\n")))}p.isMDXComponent=!0}}]);